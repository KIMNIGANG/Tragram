<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
  <%= stylesheet_link_tag 'projects', media: 'all', 'data-turbolinks-track': 'reload' %>
</head>

<!--projectページ-->
<div class="header">
  <%if logged_in?%>
    <!--metadata-->
    <h1 class="name"><%= @project.name%></h1>
    <p class="caption"><%= @project.caption%></p>

    <div class="project_btns">
    <%= link_to edit_project_path(@project.id), class: "btn" do %>
      <i class="fa-solid fa-pen-to-square"></i>旅行詳細を編集
    <% end %>

    <%= link_to project_path(@project.id), class: "btn destroy", :method => :delete, data: {confirm: "旅行ページを削除しますか？一度削除すると元に戻すことができません"} do %>
      <i class="fa-solid fa-trash-alt"></i>旅行ページを削除
    <% end %>
    </div>

    <div class="invitation">
      <details>
        <summary>招待リンクを表示</summary>
        <p>https://localhost:3001/projects/<%= params[:id] %>/invite</p>
      </details>
    </div>

    <br>

  <div class="create_post">
    <%= link_to new_post_path(project_id: params[:id]), class: "btn create_btn" do %>
      Create Post
    <% end %>
  </div>

</div>


  <div class="card-deck">
  <% @posts.each do |post| %>
    <div class="card post_card"  style="width:18rem;">
      <% media = post.images.first %>
      <% if media.present?%>
        <% if media.media_type == 'IMAGE' then %>
          <img src = <%= media.url %>  class="card-img-top">
        <% else %>
          <video controls autoplay name="media" class="card-img-top">
            <source src=<%= media.url %> type="video/mp4">
            <source src=<%= media.url %> type="video/webm">
          </video>
        <% end %>
      <% end %>
      <div class="card-body">
        <h5 class="card-title">
        <%= post.name %>
        </h5>
        <p class="card-text text-truncate" style="max-height: 100px;">
        <%= safe_join(post.caption.split("\n"),tag(:br)) %>
        </p>
        <%= link_to post_path(post.id), class: "btn info_btn" do %>
          投稿詳細
        <% end %>
      </div>
    </div>
  <% end %>
  </div>

  <div id="map"></div>
  <script
  src="https://maps.googleapis.com/maps/api/js?key=<%=ENV['GOOGLE_MAP_API_KEY']%>&callback=initMap&v=weekly"
  defer></script>

  <ol>
  <% @location.each do |location| %>
    <li>
      <%= location[:name] %>
      <%= location[:lat] %>
      <%= location[:lng] %>
      <input type="hidden" class="name" value="<%= location[:name] %>">
      <input type="hidden" class="lat" value="<%= location[:lat] %>">
      <input type="hidden" class="lng" value="<%= location[:lng] %>">
    </li>
    <br>
  <% end %>
  </ol>

  <div id="test"></div>

<% end %>

  <%= javascript_pack_tag 'map_project', 'data-turbolinks-track': 'reload'%>
>>>>>>> main
